<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ruoyi.business.mapper.DataPoolTemplateMapper">

    <resultMap id="DataPoolTemplateResult" type="com.ruoyi.business.domain.DataPoolTemplate">
        <id     property="id"          column="id" />
        <result property="poolId"      column="pool_id" />
        <result property="tempName"    column="temp_name" />
        <result property="tempContent" column="temp_content" />
        <result property="xAxis"       column="x_axis" />
        <result property="yAxis"       column="y_axis" />
        <result property="angle"       column="angle" />
        <result property="width"       column="width" />
        <result property="height"      column="height" />
        <result property="delFlag"     column="del_flag" />
        <result property="createTime"  column="create_time" />
        <result property="updateTime"  column="update_time" />
    </resultMap>

    <sql id="Base_Column_List">
        id, pool_id, temp_name, temp_content, x_axis, y_axis, angle, width, height, del_flag, create_time, update_time
    </sql>

    <select id="selectDataPoolTemplateById" resultMap="DataPoolTemplateResult">
        select <include refid="Base_Column_List"/>
        from data_pool_template
        where id = #{id}
    </select>

    <select id="selectDataPoolTemplateList" resultMap="DataPoolTemplateResult">
        select <include refid="Base_Column_List"/>
        from data_pool_template
        <where>
            del_flag = '0'
            <if test="poolId != null">and pool_id = #{poolId}</if>
            <if test="tempName != null and tempName != ''">and temp_name like concat('%', #{tempName}, '%')</if>
        </where>
        order by id desc
    </select>

    <select id="selectDataPoolTemplateListByPoolId" resultMap="DataPoolTemplateResult">
        select <include refid="Base_Column_List"/>
        from data_pool_template
        where del_flag = '0' and pool_id = #{poolId}
        order by id desc
    </select>

    <insert id="insertDataPoolTemplate" parameterType="com.ruoyi.business.domain.DataPoolTemplate">
        insert into data_pool_template
        (pool_id, temp_name, temp_content, x_axis, y_axis, angle, width, height, del_flag, create_time, update_time)
        values
        (#{poolId}, #{tempName}, #{tempContent}, #{xAxis}, #{yAxis}, #{angle}, #{width}, #{height}, '0', datetime('now'), datetime('now'))
    </insert>

    <update id="updateDataPoolTemplate" parameterType="com.ruoyi.business.domain.DataPoolTemplate">
        update data_pool_template
        <set>
            <if test="poolId != null">pool_id = #{poolId},</if>
            <if test="tempName != null">temp_name = #{tempName},</if>
            <if test="tempContent != null">temp_content = #{tempContent},</if>
            <if test="xAxis != null">x_axis = #{xAxis},</if>
            <if test="yAxis != null">y_axis = #{yAxis},</if>
            <if test="angle != null">angle = #{angle},</if>
            <if test="width != null">width = #{width},</if>
            <if test="height != null">height = #{height},</if>
            update_time = datetime('now')
        </set>
        where id = #{id}
    </update>

    <update id="deleteDataPoolTemplateById">
        update data_pool_template set del_flag = '2', update_time = datetime('now') where id = #{id}
    </update>

    <update id="deleteDataPoolTemplateByIds">
        update data_pool_template set del_flag = '2', update_time = datetime('now') where id in
        <foreach item="id" collection="array" open="(" separator="," close=")">#{id}</foreach>
    </update>

</mapper>


